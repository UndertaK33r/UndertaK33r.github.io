<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <title>
    
    ä»TCPé»åŒ…å‡ºå‘ï¼Œçœ‹çœ‹ä»£ç ç”¨åˆ°çš„ä¸€äº›åº“ - 
    Undertaker&#39;s Blog
  </title>
  <meta property="og:title" content="ä»TCPé»åŒ…å‡ºå‘ï¼Œçœ‹çœ‹ä»£ç ç”¨åˆ°çš„ä¸€äº›åº“ - Undertaker&#39;s Blog" />
  <meta property="og:site_name" content="Undertaker&#39;s Blog" />

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  

  <meta property="og:type" content="article" />


  
  <link rel="shortcut icon" href="/mylogo.ico" />
  

  

  
  <link rel="canonical" href="https://undertak33r.github.io/2025/09/24/%E4%BB%8ETCP%E9%BB%8F%E5%8C%85%E5%87%BA%E5%8F%91%EF%BC%8C%E7%9C%8B%E7%9C%8B%E4%BB%A3%E7%A0%81%E7%94%A8%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%BA%93/">
  <meta name="og:url" content="https://undertak33r.github.io/2025/09/24/%E4%BB%8ETCP%E9%BB%8F%E5%8C%85%E5%87%BA%E5%8F%91%EF%BC%8C%E7%9C%8B%E7%9C%8B%E4%BB%A3%E7%A0%81%E7%94%A8%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%BA%93/">
  
  <!-- ç°ä»£åŒ–å­—ä½“åŠ è½½ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <!-- particles.js åº“ -->
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  
  
<link rel="stylesheet" href="/css/style.css">


<meta name="generator" content="Hexo 8.0.0"></head>

<body>
  <!-- particles.js ç²’å­ç³»ç»Ÿå®¹å™¨ -->
  <div id="particles-js"></div>
  
  <div class="title">
  <img class="title_img" alt="Title image" width="300" height="300" src="/images/mylogo.jpg" /><br>
  <div id="site_title">Undertaker's Blog</div>
</div>
  <div class="navi">
  <a id="navi_item_title" href="/#" class="menu-item-link">
    ä¸»é¡µ
  </a>
  <a id="navi_item_tags" href="/tags" class="menu-item-link">
    æ ‡ç­¾
  </a>
  <a id="navi_item_about" href="/about" class="menu-item-link">
    å…³äº
  </a>
  <a id="navi_item_search" href="/search" class="menu-item-link">
    æœç´¢
  </a>
  
</div>

<hr />

  <div class="main">
    
<link rel="stylesheet" href="/css/post.css">

<post>

  <div class="post_title">
    ä»TCPé»åŒ…å‡ºå‘ï¼Œçœ‹çœ‹ä»£ç ç”¨åˆ°çš„ä¸€äº›åº“
  </div>

  <br /><br />

  <div id="post_content">
    <h4 id="å‚è€ƒè¿æ¥ï¼š-https-www-topgoer-com-E7-BD-91-E7-BB-9C-E7-BC-96-E7-A8-8B-socket-E7-BC-96-E7-A8-8B-TCP-E9-BB-8F-E5-8C-85-html"><a href="#å‚è€ƒè¿æ¥ï¼š-https-www-topgoer-com-E7-BD-91-E7-BB-9C-E7-BC-96-E7-A8-8B-socket-E7-BC-96-E7-A8-8B-TCP-E9-BB-8F-E5-8C-85-html" class="headerlink" title="å‚è€ƒè¿æ¥ï¼š https://www.topgoer.com/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/socket%E7%BC%96%E7%A8%8B/TCP%E9%BB%8F%E5%8C%85.html"></a>å‚è€ƒè¿æ¥ï¼š <a target="_blank" rel="noopener" href="https://www.topgoer.com/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/socket%E7%BC%96%E7%A8%8B/TCP%E9%BB%8F%E5%8C%85.html">https://www.topgoer.com/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/socket%E7%BC%96%E7%A8%8B/TCP%E9%BB%8F%E5%8C%85.html</a></h4><h3 id="æœåŠ¡ç«¯ä»£ç "><a href="#æœåŠ¡ç«¯ä»£ç " class="headerlink" title="æœåŠ¡ç«¯ä»£ç "></a>æœåŠ¡ç«¯ä»£ç </h3><p>&#x2F;server&#x2F;server.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;bufio&quot;</span><br>	<span class="hljs-string">&quot;fmt&quot;</span><br>	<span class="hljs-string">&quot;io&quot;</span><br>	<span class="hljs-string">&quot;net&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">process</span><span class="hljs-params">(conn net.Conn)</span></span> &#123;<br>	<span class="hljs-keyword">defer</span> conn.Close()<br>	reader := bufio.NewReader(conn)<br>	<span class="hljs-keyword">var</span> buf [<span class="hljs-number">1024</span>]<span class="hljs-type">byte</span><br>	<span class="hljs-keyword">for</span> &#123;<br>		n, err := reader.Read(buf[:])<br>		<span class="hljs-keyword">if</span> err == io.EOF &#123;<br>			<span class="hljs-keyword">break</span><br>		&#125;<br>		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>			fmt.Println(<span class="hljs-string">&quot;read from client failed, err:&quot;</span>, err)<br>			<span class="hljs-keyword">break</span><br>		&#125;<br>		recvStr := <span class="hljs-type">string</span>(buf[:n])<br>		fmt.Println(<span class="hljs-string">&quot;æ”¶åˆ°clientå‘æ¥çš„æ•°æ®ï¼š&quot;</span>, recvStr)<br>	&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><br>	listen, err := net.Listen(<span class="hljs-string">&quot;tcp&quot;</span>, <span class="hljs-string">&quot;127.0.0.1:30000&quot;</span>)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		fmt.Println(<span class="hljs-string">&quot;listen failed, err:&quot;</span>, err)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	<span class="hljs-keyword">defer</span> listen.Close()<br>	<span class="hljs-keyword">for</span> &#123;<br>		conn, err := listen.Accept()<br>		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>			fmt.Println(<span class="hljs-string">&quot;accept failed, err:&quot;</span>, err)<br>			<span class="hljs-keyword">continue</span><br>		&#125;<br>		<span class="hljs-keyword">go</span> process(conn)<br>	&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h3 id="å®¢æˆ·ç«¯ä»£ç "><a href="#å®¢æˆ·ç«¯ä»£ç " class="headerlink" title="å®¢æˆ·ç«¯ä»£ç "></a>å®¢æˆ·ç«¯ä»£ç </h3><p>&#x2F;client&#x2F;client.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;fmt&quot;</span><br>	<span class="hljs-string">&quot;net&quot;</span><br>	<span class="hljs-string">&quot;sync&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	conn, err := net.Dial(<span class="hljs-string">&quot;tcp&quot;</span>, <span class="hljs-string">&quot;127.0.0.1:30000&quot;</span>)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		fmt.Println(<span class="hljs-string">&quot;dial failed, err&quot;</span>, err)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	<span class="hljs-keyword">var</span> wg sync.WaitGroup<br>	<span class="hljs-keyword">defer</span> conn.Close()<br>	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">20</span>; i++ &#123;<br>		<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>			<span class="hljs-keyword">defer</span> wg.Done()<br>			msg := fmt.Sprintf(<span class="hljs-string">&quot;hello %d&quot;</span>, i)<br>			conn.Write([]<span class="hljs-type">byte</span>(msg))<br>		&#125;()<br>		wg.Add(<span class="hljs-number">1</span>)<br>	&#125;<br>	wg.Wait()<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ï¼ˆå…¶å®è¿™é‡Œä¸ä¸€å®šè¦ç”¨goroutineå’Œwaitgroupï¼Œä½†åŸºæœ¬ä¸Šå†™ä»£ç æ—¶å€™æ²¡æ€ä¹ˆå®æ“è¿‡goroutineæ‰€ä»¥åœ¨è¿™é‡Œé¡ºæ‰‹å†™ä¸€ä¸‹å°±å½“ç»ƒä¹ ï¼‰</p>
<p>è™½ç„¶å†™äº†ä¸å°‘çš„goä»£ç ï¼Œä½†æœ‰äº›æ—¶å€™å•çº¯ç”¨è¿‡ç¬¬äºŒæ¬¡çœ‹çš„æ—¶å€™ç¬¬ä¸€æ—¶é—´è¿˜æ˜¯æƒ³ä¸èµ·æ¥è¿™ç©æ„æ˜¯å¹²ä»€ä¹ˆçš„ï¼Œç´¢æ€§ç›´æ¥ä»Šå¤©è´´ä¸Šä»£ç æ—¶å€™æŠŠåº“çš„æºç çœ‹ä¸€çœ‹ã€‚</p>
<p>å½“ç„¶æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¿™ä¸¤ä¸ªä»£ç çš„è¿è¡Œç»“æœï¼š<br>æ”¶åˆ°clientå‘æ¥çš„æ•°æ®ï¼š hello 0hello 1hello 2hello 8<br>æ”¶åˆ°clientå‘æ¥çš„æ•°æ®ï¼š hello 15hello 5<br>æ”¶åˆ°clientå‘æ¥çš„æ•°æ®ï¼š hello 6<br>â€¦<br>å¤šä½™çš„æˆ‘ä»¬å…ˆèˆå¼ƒï¼Œå‰ä¸¤è¡Œå°±èƒ½çœ‹å‡ºï¼Œéƒ¨åˆ†æ¶ˆæ¯é»åœ¨ä¸€èµ·äº†ï¼Œè¿™å°±æ˜¯TCPé»åŒ…<br>åŸå› è®©AIæ¥å›ç­”ä¸€ä¸‹ï¼š</p>
<ul>
<li>TCPç²˜åŒ…çš„æ ¹æœ¬åŸå› æ˜¯TCPåè®®æ˜¯é¢å‘å­—èŠ‚æµçš„åè®®ï¼Œå®ƒä¸ä¿è¯æ•°æ®åŒ…çš„è¾¹ç•Œã€‚</li>
<li>åœ¨TCPåè®®ä¸­ï¼Œæ•°æ®åŒ…å¯èƒ½ä¼šè¢«åˆ†ç‰‡ï¼Œå³æ•°æ®åŒ…è¢«åˆ†æˆå¤šä¸ª smaller packetsï¼Œç„¶åè¿™äº› smaller packets è¢«å‘é€åˆ°å¯¹æ–¹ï¼Œç„¶åè¿™äº› smaller packets è¢«é‡æ–°ç»„åˆæˆå®Œæ•´çš„æ•°æ®åŒ…ã€‚</li>
</ul>
<p>è¿™é‡Œæœ‰ä¸€äº›ç®—æ³•åŸå› ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>ç”±Nagleç®—æ³•é€ æˆçš„å‘é€ç«¯çš„ç²˜åŒ…ï¼šNagleç®—æ³•æ˜¯ä¸€ç§æ”¹å–„ç½‘ç»œä¼ è¾“æ•ˆç‡çš„ç®—æ³•ã€‚ç®€å•æ¥è¯´å°±æ˜¯å½“æˆ‘ä»¬æäº¤ä¸€æ®µæ•°æ®ç»™TCPå‘é€æ—¶ï¼ŒTCPå¹¶ä¸ç«‹åˆ»å‘é€æ­¤æ®µæ•°æ®ï¼Œè€Œæ˜¯ç­‰å¾…ä¸€å°æ®µæ—¶é—´çœ‹çœ‹åœ¨ç­‰å¾…æœŸé—´æ˜¯å¦è¿˜æœ‰è¦å‘é€çš„æ•°æ®ï¼Œè‹¥æœ‰åˆ™ä¼šä¸€æ¬¡æŠŠè¿™ä¸¤æ®µæ•°æ®å‘é€å‡ºå»ã€‚</li>
<li>æ¥æ”¶ç«¯æ¥æ”¶ä¸åŠæ—¶é€ æˆçš„æ¥æ”¶ç«¯ç²˜åŒ…ï¼šTCPä¼šæŠŠæ¥æ”¶åˆ°çš„æ•°æ®å­˜åœ¨è‡ªå·±çš„ç¼“å†²åŒºä¸­ï¼Œç„¶åé€šçŸ¥åº”ç”¨å±‚å–æ•°æ®ã€‚å½“åº”ç”¨å±‚ç”±äºæŸäº›åŸå› ä¸èƒ½åŠæ—¶çš„æŠŠTCPçš„æ•°æ®å–å‡ºæ¥ï¼Œå°±ä¼šé€ æˆTCPç¼“å†²åŒºä¸­å­˜æ”¾äº†å‡ æ®µæ•°æ®ã€‚</li>
</ul>
<p>è§£å†³åŠæ³•å°±æ˜¯ç”¨ç¼–è§£ç ï¼Œå®é™…ä¸Šç¼–è§£ç çš„ä½œç”¨å¾ˆå¤šï¼Œè¿™é‡Œä¼¼ä¹æ˜¯é¡ºæ‰‹å°±è§£å†³äº†é»åŒ…é—®é¢˜ğŸ˜€</p>
<p>è¿˜æ˜¯å…ˆæ¥çœ‹çœ‹ä¸Šé¢çš„ä»£ç çš„ä¸€äº›å‡½æ•°çš„è§£é‡Šå§ã€‚è¿™é‡Œè¿˜æ˜¯ä¸ç»™å‡ºå…·ä½“ä»£ç çš„è§£é‡Šï¼Œæ¥çœ‹çœ‹æºç éœ€è¦ä»€ä¹ˆå‚æ•°</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// Conn is a generic stream-oriented network connection.</span><br><span class="hljs-comment">// Conn æ˜¯ä¸€ç§é€šç”¨çš„é¢å‘æµçš„ç½‘ç»œè¿æ¥ã€‚</span><br><span class="hljs-comment">// Multiple goroutines may invoke methods on a Conn simultaneously.</span><br><span class="hljs-comment">// å¤šä¸ª goroutine å¯ä»¥åŒæ—¶è°ƒç”¨ Conn ä¸Šçš„æ–¹æ³•ã€‚</span><br><span class="hljs-comment">// æ€»ä¹‹Conn æ¥å£å®šä¹‰äº†é€šç”¨çš„é¢å‘æµçš„ç½‘ç»œè¿æ¥ï¼Œæ”¯æŒè¯»å†™ã€å…³é—­ã€åœ°å€è·å–åŠè¶…æ—¶æ§åˆ¶ã€‚</span><br><span class="hljs-keyword">type</span> Conn <span class="hljs-keyword">interface</span> &#123;<br>    Read(b []<span class="hljs-type">byte</span>) (n <span class="hljs-type">int</span>, err <span class="hljs-type">error</span>)<br>    Write(b []<span class="hljs-type">byte</span>) (n <span class="hljs-type">int</span>, err <span class="hljs-type">error</span>)<br>    Close() <span class="hljs-type">error</span><br>    <span class="hljs-comment">//...è¿˜æœ‰ä¸€äº›æš‚æ—¶æ²¡ç”¨åˆ°å…ˆçœç•¥</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ‰€ä»¥è¯´TCPå±äºè¿™ä¸ªå®šä¹‰æœ‰å…¶å®ç°ï¼Œé‚£ä¹ˆæˆ‘ä»¬çœ‹åˆ°mainå‡½æ•°é‡Œé¢</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go">listen, err := net.Listen(<span class="hljs-string">&quot;tcp&quot;</span>, <span class="hljs-string">&quot;127.0.0.1:30000&quot;</span>)<br>conn, err := listen.Accept()<br><span class="hljs-keyword">go</span> process(conn)<br></code></pre></td></tr></table></figure>
<p>ä¸»è¦å°±æ˜¯è¿™ä¸‰ä¸ªå‡½æ•°<br>é‚£ä¹ˆæ¥çœ‹çœ‹net.Listen()</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//Listen å‡½æ•°ç”¨äºåœ¨æœ¬åœ°ç½‘ç»œåœ°å€ä¸Šç›‘å¬ä¼ å…¥çš„è¿æ¥ã€‚å®ƒæ”¯æŒ TCPã€Unix åŸŸå¥—æ¥å­—ç­‰åè®®ï¼Œå¹¶æ ¹æ®éœ€è¦è‡ªåŠ¨é€‰æ‹©ç«¯å£ã€‚ä½¿ç”¨æ—¶éœ€æŒ‡å®šç½‘ç»œç±»å‹å’Œåœ°å€ï¼Œè¿”å›ä¸€ä¸ª Listener å®ä¾‹ã€‚</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Listen</span><span class="hljs-params">(network, address <span class="hljs-type">string</span>)</span></span> (Listener, <span class="hljs-type">error</span>) &#123;<br>	<span class="hljs-keyword">var</span> lc ListenConfig<br>	<span class="hljs-keyword">return</span> lc.Listen(context.Background(), network, address)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ€»ä¹‹å°±æ˜¯ åˆ›å»ºä¸€ä¸ªç›‘å¬å™¨ï¼Œå®ƒä¼šä¸€ç›´ç›‘å¬æŒ‡å®šçš„åœ°å€å’Œç«¯å£<br>Accept() æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªè¿æ¥å¯¹è±¡ï¼Œç”±äºç›‘å¬å™¨æŒ‡å®šäº†tcpï¼Œæ‰€ä»¥è¿”å›çš„è¿æ¥å¯¹è±¡ä¹Ÿæ˜¯tcpè¿æ¥å¯¹è±¡</p>
<p>å›åˆ°processæ–¹æ³•<br>n, err :&#x3D; reader.Read(buf[:]) è¿™å°±æ˜¯è®©ç¼“å†²å™¨æ¥å—è¯»åˆ°çš„æ•°æ®</p>
<p>æ¥ä¸‹æ¥çœ‹çœ‹å®¢æˆ·ç«¯çš„ä¸€äº›æ–¹æ³•</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//è¿™æ˜¯ä¸€ä¸ªä¾¿æ·å‡½æ•°ï¼Œå°è£…äº†ç½‘ç»œè¿æ¥çš„åˆ›å»ºè¿‡ç¨‹ï¼Œæ”¯æŒTCPã€UDPã€IPç­‰åè®®ã€‚</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Dial</span><span class="hljs-params">(network, address <span class="hljs-type">string</span>)</span></span> (Conn, <span class="hljs-type">error</span>) &#123;<br>    <span class="hljs-keyword">var</span> d Dialer<br>	<span class="hljs-keyword">return</span> d.Dial(network, address)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>å°±æ˜¯å’Œæˆ‘ä»¬çš„æœåŠ¡ç«¯å¯¹ä¸Šè¿æ¥äº†<br>å’±ä»¬è¿™é‡Œæœ‰ä¸¤ä¸ªconnï¼Œä¸€ä¸ªæ˜¯connæ˜¯æœåŠ¡ç«¯ï¼Œconnæ˜¯å®¢æˆ·ç«¯ï¼Œç›¸å½“äºä¸€ä¸ªç®¡å­çš„ä¸¤ä¸ªå£å­ï¼Œå¾€é‡Œé¢åšäº‹æƒ…ä¸¤è¾¹éƒ½èƒ½æ”¶å¾—åˆ°<br>æ‰€ä»¥conn.Write([]byte(msg))<br>åœ¨æœåŠ¡ç«¯å¯ä»¥æ¥å—å¾—åˆ°</p>
<hr>
<p>æ¥ä¸‹æ¥çœ‹çœ‹ç¼–è§£ç æ€ä¹ˆåš</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> proto<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;bufio&quot;</span><br>	<span class="hljs-string">&quot;bytes&quot;</span><br>	<span class="hljs-string">&quot;encoding/binary&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Encode</span><span class="hljs-params">(message <span class="hljs-type">string</span>)</span></span> ([]<span class="hljs-type">byte</span>, <span class="hljs-type">error</span>) &#123;<br>	<span class="hljs-comment">//å‰4å­—èŠ‚è¡¨ç¤ºé•¿åº¦</span><br>	<span class="hljs-keyword">var</span> length = <span class="hljs-type">int32</span>(<span class="hljs-built_in">len</span>(message))<br>	<span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªå­—èŠ‚ç¼“å†²åŒº</span><br>	<span class="hljs-keyword">var</span> pkg = <span class="hljs-built_in">new</span>(bytes.Buffer)<br><br>	<span class="hljs-comment">//å†™å…¥é•¿åº¦</span><br>	<span class="hljs-comment">//Writeå‡½æ•°æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯io.Writerï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç¼–ç æ ¼å¼ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¦å†™å…¥çš„æ•°æ®</span><br>	err := binary.Write(pkg, binary.LittleEndian, length)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<br>	&#125;<br><br>	err = binary.Write(pkg, binary.LittleEndian, []<span class="hljs-type">byte</span>(message))<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<br>	&#125;<br>	<span class="hljs-keyword">return</span> pkg.Bytes(), <span class="hljs-literal">nil</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Decode</span><span class="hljs-params">(reader *bufio.Reader)</span></span> (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) &#123;<br>	<span class="hljs-comment">//length æ˜¯åŸå§‹æ•°æ®ï¼Œsize æ˜¯ç»è¿‡è§£ç åçš„æœ‰æ„ä¹‰çš„é•¿åº¦å€¼ã€‚</span><br>	length, _ := reader.Peek(<span class="hljs-number">4</span>)<br>	buf := bytes.NewBuffer(length)<br>	<span class="hljs-keyword">var</span> size <span class="hljs-type">int32</span><br>	<span class="hljs-comment">//æŠŠé•¿åº¦è¯»åˆ°sizeé‡Œé¢</span><br>	err := binary.Read(buf, binary.LittleEndian, &amp;size)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>, err<br>	&#125;<br>	<span class="hljs-comment">// ä¸»è¦å¤„ç†ç²˜åŒ…é—®é¢˜çš„ä»£ç </span><br>	<span class="hljs-comment">// ä¿è¯æ•°æ®å®Œæ•´æ€§ï¼Œç¼“å†²åŒºä¸­çš„æ•°æ®è¶³å¤Ÿæ„æˆä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒ…</span><br>	<span class="hljs-keyword">if</span> <span class="hljs-type">int32</span>(reader.Buffered()) &lt; size+<span class="hljs-number">4</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>, err<br>	&#125;<br><br>	pack := <span class="hljs-built_in">make</span>([]<span class="hljs-type">byte</span>, <span class="hljs-type">int</span>(<span class="hljs-number">4</span>+size))<br>	_, err = reader.Read(pack)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>, err<br>	&#125;<br>	<span class="hljs-keyword">return</span> <span class="hljs-type">string</span>(pack[<span class="hljs-number">4</span>:]), <span class="hljs-literal">nil</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™æ¬¡æ‡’å¾—å†æ·±å…¥äº†ï¼Œè¡¥å……äº†ä¸€äº›æ³¨è§£<br>åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è°ƒç”¨å³å¯ï¼Œä¸»è¦çœ‹çœ‹è¿™ä¸¤ä¸ªå‡½æ•°éœ€è¦æ¥å—ä»€ä¹ˆå‚æ•°ç„¶åæŠŠåŸä»£ç ä¸­æœ‰çš„ç±»å‹æŒ‰éœ€æ±‚æ”¾è¿›å»å°±è¡Œã€‚<br>è¯¦æƒ…è§å‚è€ƒé“¾æ¥ã€‚</p>

  </div>

  <br />

  
  <br /><br />


  

<div id="copyright">

  <a id="license-image" rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img height="15" width="80" alt="çŸ¥è¯†å…±äº« ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" />
  </a>

  <p id="license-word-hyper">
    æœ¬ä½œå“é‡‡ç”¨
    <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
    çŸ¥è¯†å…±äº« ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®</a>
    è¿›è¡Œè®¸å¯ã€‚
  </p>
</div>

  <div id="top">
  <div onclick="window.scrollTo({top: 0, behavior: 'smooth'})">â–²</div>
  <div onclick="document.getElementById('footer').scrollIntoView({behavior: 'smooth'})">â–¼</div>
</div>
  

</post>
  </div>

  <foot id="footer">
  <hr class="boldline" />
  <br>

  <p class="center font">
    
    <a target="_blank" rel="noopener" href="https://github.com/UndertaK33r" aria-label="GitHub">
  <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
   <path class="icon_path" d="M427.392 853.504a61.44 61.44 0 0 1-1.450667 15.530667 92.586667 92.586667 0 0 1-10.965333 27.605333c-15.061333 25.301333-40.661333 42.154667-73.642667 42.154667-77.653333 0-108.117333-38.101333-146.261333-133.504C169.216 740.693333 157.013333 725.461333 128 725.461333v-85.333333c77.653333 0 108.117333 38.101333 146.261333 133.504 25.856 64.597333 38.058667 79.786667 67.072 79.786667 0-12.373333-0.170667-23.296-0.512-38.144-0.853333-34.816-0.938667-41.941333 0.554667-51.2 0.64-20.352 5.888-34.773333 16.384-49.066667-95.232-20.736-159.445333-63.573333-196.309333-132.992l-13.824-32.426667C134.186667 510.848 128 467.072 128 416.426667c0-58.24 17.749333-110.336 50.944-153.856-10.368-41.386667-8.96-91.989333 13.909333-149.077334l7.466667-18.688 19.2-6.101333c2.56-0.853333 5.632-1.578667 9.301333-2.133333 37.290667-5.888 90.325333 8.106667 159.701334 52.48a565.930667 565.930667 0 0 1 127.274666-14.208c38.741333 0 77.226667 3.882667 114.048 11.605333 67.456-42.24 119.04-55.509333 155.306667-49.92 3.626667 0.597333 6.741333 1.322667 9.258667 2.133333l19.285333 6.101334 7.466667 18.773333c20.010667 50.218667 23.424 96.469333 16.128 136.96C875.434667 296.32 896 352.597333 896 416.512c0 53.888-3.84 94.378667-14.933333 133.802667l-11.733334 32.170666c-30.677333 69.333333-98.304 112.64-202.538666 133.248 10.837333 15.018667 15.872 30.250667 15.872 52.394667v42.666667l-0.042667 42.666666a13.013333 13.013333 0 0 0 0.341333 2.730667L682.666667 938.794667c-36.352 0-63.36-17.706667-76.672-45.653334a88.277333 88.277333 0 0 1-8.661334-40.277333v-84.736c0-3.584-0.128-3.797333-8.832-12.501333-23.296-23.296-33.834667-40.874667-33.834666-72.832v-38.613334l38.4-3.84c114.346667-11.52 176.512-43.221333 197.12-89.6l9.6-26.325333c7.68-27.562667 10.88-61.098667 10.88-107.946667 0-49.706667-17.365333-90.837333-50.218667-123.648L742.4 274.773333l7.381333-24.448c6.528-21.717333 8.106667-47.402667 1.152-76.714666a158.634667 158.634667 0 0 0-3.584 0.938666c-22.826667 6.4-51.370667 20.053333-85.76 43.008l-15.658666 10.453334-18.304-4.522667a467.754667 467.754667 0 0 0-111.829334-13.269333c-42.709333 0-84.906667 5.418667-123.946666 16.042666l-19.029334 5.205334-16.256-11.136c-35.541333-24.32-65.109333-38.826667-88.746666-45.568a158.293333 158.293333 0 0 0-4.864-1.28c-8.234667 33.92-4.992 61.781333 3.413333 82.688l9.984 25.088-18.346667 19.797333C228.693333 332.629333 213.333333 370.986667 213.333333 416.512c0 41.685333 4.864 76.202667 13.824 102.229333l11.178667 26.453334c27.904 52.352 87.168 83.84 192.853333 95.146666l38.144 4.096v38.357334c0 32-10.538667 49.536-33.834666 72.832-8.704 8.704-8.832 8.96-8.832 12.501333l-0.725334 7.893333c-0.512 2.56-0.512 9.258667 0.170667 37.205334 0.298667 12.8 0.469333 22.997333 0.554667 33.621333a33.962667 33.962667 0 0 1 0.725333 6.656z"/>
  </svg>
 </a>

    
    
    <a href="mailto:2331627921@qq.com" aria-label="Email">
  <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <path d="M513.78 602.99c-27.28 0.45-53.79-9.09-74.53-26.83l-65.96-56.64c-15.64-13.37-17.48-36.9-4.1-52.54 13.38-15.65 36.9-17.48 52.54-4.1l65.96 56.64c13.68 11.1 33.27 11.1 46.95 0L881.2 253.08l-708.02-2.61c-20.58 0-37.26-16.69-37.26-37.26s16.68-37.26 37.26-37.26H881.2c41.09-2.36 76.32 29.05 78.67 70.14a74.519 74.519 0 0 1-32.46 65.87L580.86 578.38a111.842 111.842 0 0 1-67.08 24.61z m444.57 133.4V438.28c0-20.58-16.68-37.26-37.26-37.26s-37.26 16.69-37.26 37.26V736.4c0 20.58-16.68 37.26-37.26 37.26h-521.7c-20.58 0-37.26 16.69-37.26 37.26s16.68 37.26 37.26 37.26h521.7c61.72 0.01 111.78-50.05 111.78-111.79zM362.12 363.75c0-20.58-16.68-37.26-37.26-37.26h-223.6c-20.58 0-37.26 16.69-37.26 37.26s16.68 37.26 37.26 37.26h223.59c20.58 0.01 37.27-16.68 37.27-37.26z m0 298.12c0-20.58-16.68-37.26-37.26-37.26h-111.8c-20.58 0-37.26 16.69-37.26 37.26s16.68 37.26 37.26 37.26h111.79c20.58 0 37.27-16.69 37.27-37.26z"/>
  </svg>
</a>

    
    
    
    
    
    
    
    
    
  <p>
    <br>
  <p id="hitokoto">:D è·å–ä¸­...</p>
  <script src="https://v1.hitokoto.cn/?c=a&encode=js&select=%23hitokoto" defer></script>
  <br>
  <p class="center font">
    &copy - <a href="https://UndertaK33r.github.io">UndertaK33r</a> -  2025 - Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>  Theme <a target="_blank" rel="noopener" href="https://github.com/pcrab/hexo-theme-quark"> Quark </a> 
  </p>
  
  <br />
</foot>
  
  <!-- particles.js åˆå§‹åŒ–è„šæœ¬ -->
  <script>
    // particles.js é…ç½® - é€‚åº¦å¢å¼ºç²’å­æ•ˆæœ
    particlesJS('particles-js', {
      "particles": {
        "number": {
          "value": 55,  /* é€‚åº¦å¢åŠ ç²’å­æ•°é‡ */
          "density": {
            "enable": true,
            "value_area": 1000  /* é€‚åº¦å¢åŠ å¯†åº¦ */
          }
        },
        "color": {
          "value": "#7dd3fc"
        },
        "shape": {
          "type": "circle",
          "stroke": {
            "width": 0,
            "color": "#000000"
          }
        },
        "opacity": {
          "value": 0.45,  /* æé«˜é€æ˜åº¦ï¼Œå¢å¼ºå¯è§åº¦ */
          "random": true,
          "anim": {
            "enable": true,
            "speed": 0.8,  /* é€‚åº¦åŠ å¿«é€æ˜åº¦å˜åŒ– */
            "opacity_min": 0.1,
            "sync": false
          }
        },
        "size": {
          "value": 2,  /* é€‚åº¦å¢å¤§ç²’å­å°ºå¯¸ */
          "random": true,
          "anim": {
            "enable": true,
            "speed": 1.2,  /* åŠ å¿«å¤§å°å˜åŒ– */
            "size_min": 0.3,
            "sync": false
          }
        },
        "line_linked": {
          "enable": true,
          "distance": 130,  /* å¢åŠ è¿æ¥è·ç¦»ï¼Œæ›´å®¹æ˜“å½¢æˆç½‘ç»œ */
          "color": "#7dd3fc",
          "opacity": 0.25,  /* é€‚åº¦æé«˜è¿æ¥çº¿é€æ˜åº¦ */
          "width": 1
        },
        "move": {
          "enable": true,
          "speed": 1.2,  /* é€‚åº¦åŠ å¿«ç§»åŠ¨é€Ÿåº¦ */
          "direction": "none",
          "random": true,
          "straight": false,
          "out_mode": "out",
          "bounce": false,
          "attract": {
            "enable": false,
            "rotateX": 600,
            "rotateY": 1200
          }
        }
      },
      "interactivity": {
        "detect_on": "canvas",
        "events": {
          "onhover": {
            "enable": true,
            "mode": "grab"  /* ä¿æŒé¼ æ ‡äº¤äº’ */
          },
          "onclick": {
            "enable": true,  /* é‡æ–°å¯ç”¨ç‚¹å‡»äº¤äº’ï¼Œå¢åŠ äº’åŠ¨æ€§ */
            "mode": "push"
          },
          "resize": true
        },
        "modes": {
          "grab": {
            "distance": 150,  /* å¢åŠ æŠ“å–è·ç¦» */
            "line_linked": {
              "opacity": 0.5  /* æŠ“å–æ—¶çº¿æ¡æ›´æ˜æ˜¾ */
            }
          },
          "bubble": {
            "distance": 100,
            "size": 40,
            "duration": 2,
            "opacity": 8,
            "speed": 3
          },
          "repulse": {
            "distance": 200,
            "duration": 0.4
          },
          "push": {
            "particles_nb": 3  /* ç‚¹å‡»æ—¶æ·»åŠ 3ä¸ªç²’å­ */
          },
          "remove": {
            "particles_nb": 2
          }
        }
      },
      "retina_detect": true
    });
  </script>
</body>

</html>