<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <title>
    
    Goå…«è‚¡ä¹‹å¹¶å‘ç¼–ç¨‹ï¼ˆ2ï¼‰ - 
    Undertaker&#39;s Blog
  </title>
  <meta property="og:title" content="Goå…«è‚¡ä¹‹å¹¶å‘ç¼–ç¨‹ï¼ˆ2ï¼‰ - Undertaker&#39;s Blog" />
  <meta property="og:site_name" content="Undertaker&#39;s Blog" />

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  

  <meta property="og:type" content="article" />


  
  <link rel="shortcut icon" href="/mylogo.ico" />
  

  

  
  <link rel="canonical" href="https://undertak33r.github.io/2025/09/25/Go%E5%85%AB%E8%82%A1%E4%B9%8B%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%EF%BC%882%EF%BC%89/">
  <meta name="og:url" content="https://undertak33r.github.io/2025/09/25/Go%E5%85%AB%E8%82%A1%E4%B9%8B%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%EF%BC%882%EF%BC%89/">
  
  <!-- ç°ä»£åŒ–å­—ä½“åŠ è½½ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <!-- particles.js åº“ -->
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  
  
<link rel="stylesheet" href="/css/style.css">


<meta name="generator" content="Hexo 8.0.0"></head>

<body>
  <!-- particles.js ç²’å­ç³»ç»Ÿå®¹å™¨ -->
  <div id="particles-js"></div>
  
  <div class="title">
  <img class="title_img" alt="Title image" width="300" height="300" src="/images/mylogo.jpg" /><br>
  <div id="site_title">Undertaker's Blog</div>
</div>
  <div class="navi">
  <a id="navi_item_title" href="/#" class="menu-item-link">
    ä¸»é¡µ
  </a>
  <a id="navi_item_tags" href="/tags" class="menu-item-link">
    æ ‡ç­¾
  </a>
  <a id="navi_item_about" href="/about" class="menu-item-link">
    å…³äº
  </a>
  <a id="navi_item_search" href="/search" class="menu-item-link">
    æœç´¢
  </a>
  
</div>

<hr />

  <div class="main">
    
<link rel="stylesheet" href="/css/post.css">

<post>

  <div class="post_title">
    Goå…«è‚¡ä¹‹å¹¶å‘ç¼–ç¨‹ï¼ˆ2ï¼‰
  </div>

  <br /><br />

  <div id="post_content">
    <h1 id="ç›¸å…³åŒ…çš„ä½¿ç”¨"><a href="#ç›¸å…³åŒ…çš„ä½¿ç”¨" class="headerlink" title="ç›¸å…³åŒ…çš„ä½¿ç”¨"></a>ç›¸å…³åŒ…çš„ä½¿ç”¨</h1><p>å‚è€ƒè¿æ¥ï¼š<a target="_blank" rel="noopener" href="https://www.topgoer.com/">https://www.topgoer.com/</a></p>
<ul>
<li>åœ¨å†™è¿™ç¯‡ä¹‹å‰è™½ç„¶çœ‹äº†ä¸€äº›åŒ…çš„ä½¿ç”¨ï¼Œä½†ä¼¼ä¹æœ¬äººå¯¹äºè¿™äº›åŒ…çš„å®è·µéå¸¸ä¹‹å°‘ï¼Œä»¥è‡³äºè‡ªå·±å¯¹è¿™æ–¹é¢çš„è®¤çŸ¥éå¸¸æµ…è–„ï¼Œå¾ˆå®¹æ˜“å¿˜è®°ã€‚</li>
<li>æ‰€ä»¥æ¥ä¸‹æ¥è¦å¿ä½æ„Ÿè§‰åˆ°éº»çƒ¦çš„å¿ƒæ€ç»™å¸¸ç”¨çš„éƒ½ç”¨ä¸€ä¸‹å¹¶ä¸”è®°å½•ä¸€ä¸‹</li>
</ul>
<h3 id="runtime"><a href="#runtime" class="headerlink" title="runtime"></a>runtime</h3><h4 id="runtime-Gosched"><a href="#runtime-Gosched" class="headerlink" title="runtime.Gosched()"></a>runtime.Gosched()</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(s <span class="hljs-type">string</span>)</span></span> &#123;<br>		<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++ &#123;<br>			fmt.Println(s)<br>		&#125;<br>	&#125;(<span class="hljs-string">&quot;world&quot;</span>)<br>	<span class="hljs-comment">// ä¸»åç¨‹</span><br>	runtime.Gosched()<br>	fmt.Println(<span class="hljs-string">&quot;hello&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>é¦–å…ˆï¼Œmainå‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªåç¨‹ï¼Œç„¶åè°ƒç”¨runtime.Gosched()ï¼Œè¿™ä¸ªå‡½æ•°ä¼šåˆ‡æ¢åˆ°å…¶ä»–åç¨‹ï¼Œç„¶åæ‰“å°helloã€‚<br>å¦‚æœæ²¡æœ‰runtime.Gosched()ï¼Œé‚£ä¹ˆmainåç¨‹ä¼šå¾ˆå¿«çš„è¿è¡Œå®Œæ¯•ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸€ä¸ªworldä¹Ÿæ‰“å°ä¸å‡ºæ¥çš„æƒ…å†µï¼ŒåŠ ä¸Šåå¿…ç„¶å…ˆæ‰“å°å‡ºä¸€ä¸ªworldã€‚</p>
<h4 id="runtime-Goexit"><a href="#runtime-Goexit" class="headerlink" title="runtime.Goexit()"></a>runtime.Goexit()</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(s <span class="hljs-type">string</span>)</span></span> &#123;<br>		<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++ &#123;<br>			runtime.Goexit()<br>			fmt.Println(s)<br>		&#125;<br>	&#125;(<span class="hljs-string">&quot;world&quot;</span>)<br>	time.Sleep(time.Second * <span class="hljs-number">3</span>)<br>	fmt.Println(<span class="hljs-string">&quot;hello&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>å°±å½“æ˜¯è¿™ä¸ªgoroutineè¿è¡Œå®Œæ¯•äº†ï¼Œåç»­å•¥ä¹Ÿä¸ä¼šå¹²äº†</p>
<h4 id="runtime-GOMAXPROCS"><a href="#runtime-GOMAXPROCS" class="headerlink" title="runtime.GOMAXPROCS()"></a>runtime.GOMAXPROCS()</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	runtime.GOMAXPROCS(<span class="hljs-number">2</span>)<br>	<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(s <span class="hljs-type">string</span>)</span></span> &#123;<br>		<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++ &#123;<br>			fmt.Println(s)<br>		&#125;<br>	&#125;(<span class="hljs-string">&quot;func1&quot;</span>)<br>	<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(s <span class="hljs-type">string</span>)</span></span> &#123;<br>		<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++ &#123;<br>			fmt.Println(s)<br>		&#125;<br>	&#125;(<span class="hljs-string">&quot;func2&quot;</span>)<br>	time.Sleep(time.Second)<br>	fmt.Println(<span class="hljs-string">&quot;finish&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>
<p>GOMAXPROCSè®¾ç½®æœ€å¤§goroutineæ‰§è¡Œçš„cpuæ•°é‡,å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯è®¾ç½®å¹¶å‘æ•°</p>
<h3 id="Sync"><a href="#Sync" class="headerlink" title="Sync"></a>Sync</h3><h4 id="WaitGroup"><a href="#WaitGroup" class="headerlink" title="WaitGroup"></a>WaitGroup</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123; <br>    <span class="hljs-keyword">var</span> wg sync.WaitGroup<br>    wg.Add(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-keyword">defer</span> wg.Done()<br>        fmt.Println(<span class="hljs-string">&quot;hello world&quot;</span>)<br>    &#125;<br>    wg.Wait()<br>&#125;<br></code></pre></td></tr></table></figure>
<p>åŠ ä¸Šåä¿è¯goroutineæ‰§è¡Œå®Œæ¯•</p>
<h4 id="Mutex"><a href="#Mutex" class="headerlink" title="Mutex"></a>Mutex</h4><p>å¸¸ç”¨çš„æœ‰äº’æ–¥é”å’Œè¯»å†™é”<br>äº’æ–¥é”æ˜¯å®Œå…¨äº’æ–¥ï¼Œä½†æ˜¯ç»å¸¸ä¼šæœ‰è¯»å¤šå†™å°‘çš„éœ€æ±‚ï¼Œæˆ‘ä»¬é«˜å¹¶å‘çš„è¯»å–ä¸æ¶‰åŠä¿®æ”¹æ•°æ®ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨è¯»å†™é”</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs go">rwmutex := sync.RWMutex&#123;&#125;<br>mutex := sync.Mutex&#123;&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span>&#123;<br>	rwmutex.RLock()<br>	<span class="hljs-comment">//...</span><br>	<span class="hljs-keyword">defer</span> rwmutex.RUnlock()<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span>&#123;<br>	mutex.Lock()<br>	<span class="hljs-comment">//...</span><br>	<span class="hljs-keyword">defer</span> mutex.Unlock()<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="Once"><a href="#Once" class="headerlink" title="Once"></a>Once</h4><p>Onceä¿è¯åªæ‰§è¡Œä¸€æ¬¡<br>çº¿ç¨‹å®‰å…¨ï¼Œå¤šä¸ª goroutine åŒæ—¶è°ƒç”¨ä¹Ÿä¸ä¼šæœ‰é—®é¢˜</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Once <span class="hljs-keyword">struct</span> &#123;<br>	_ noCopy<br>	done atomic.Uint32<br>	m    Mutex<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(o *Once)</span></span> Do(f <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span>)<br><span class="hljs-comment">//----------------------------------------</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	<span class="hljs-keyword">var</span> once sync.Once<br>	<span class="hljs-keyword">var</span> wg sync.WaitGroup<br>	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ &#123;<br>		wg.Add(<span class="hljs-number">1</span>)<br>		<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>			<span class="hljs-keyword">defer</span> wg.Done()<br>			once.Do(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>				fmt.Println(<span class="hljs-string">&quot;æˆ‘åªä¼šå‡ºç°ä¸€æ¬¡&quot;</span>)<br>			&#125;)<br>		&#125;()<br>	&#125;<br>	wg.Wait()<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="atomic"><a href="#atomic" class="headerlink" title="atomic"></a>atomic</h4><p>ç”±äºmutexåŠ é”è¦åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œè€Œä¸”æ¶‰åŠåˆ°ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ€§èƒ½ä¼šä¸‹é™<br>è€Œatomicæ˜¯ç”¨æˆ·æ€çš„ï¼ŒåŸºäº CPU æä¾›çš„åŸå­æŒ‡ä»¤ï¼Œå¯¹äºå¸¸è§çš„æ•°æ®ç±»å‹ä½¿ç”¨atomicæ“ä½œæ€§èƒ½æ›´å¥½</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> x <span class="hljs-type">int64</span><br><span class="hljs-keyword">var</span> l sync.Mutex<br><span class="hljs-keyword">var</span> wg sync.WaitGroup<br><br><span class="hljs-comment">// æ™®é€šç‰ˆåŠ å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">add</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">// x = x + 1</span><br>    x++ <span class="hljs-comment">// ç­‰ä»·äºä¸Šé¢çš„æ“ä½œ</span><br>    wg.Done()<br>&#125;<br><br><span class="hljs-comment">// äº’æ–¥é”ç‰ˆåŠ å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">mutexAdd</span><span class="hljs-params">()</span></span> &#123;<br>    l.Lock()<br>    x++<br>    l.Unlock()<br>    wg.Done()<br>&#125;<br><br><span class="hljs-comment">// åŸå­æ“ä½œç‰ˆåŠ å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">atomicAdd</span><span class="hljs-params">()</span></span> &#123;<br>    atomic.AddInt64(&amp;x, <span class="hljs-number">1</span>)<br>    wg.Done()<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    start := time.Now()<br>    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++ &#123;<br>        wg.Add(<span class="hljs-number">1</span>)<br>        <span class="hljs-comment">// go add()       // æ™®é€šç‰ˆaddå‡½æ•° ä¸æ˜¯å¹¶å‘å®‰å…¨çš„</span><br>        <span class="hljs-comment">// go mutexAdd()  // åŠ é”ç‰ˆaddå‡½æ•° æ˜¯å¹¶å‘å®‰å…¨çš„ï¼Œä½†æ˜¯åŠ é”æ€§èƒ½å¼€é”€å¤§</span><br>        <span class="hljs-keyword">go</span> atomicAdd() <span class="hljs-comment">// åŸå­æ“ä½œç‰ˆaddå‡½æ•° æ˜¯å¹¶å‘å®‰å…¨ï¼Œæ€§èƒ½ä¼˜äºåŠ é”ç‰ˆ</span><br>    &#125;<br>    wg.Wait()<br>    end := time.Now()<br>    fmt.Println(x)<br>    fmt.Println(end.Sub(start))<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="Worker-Pool"><a href="#Worker-Pool" class="headerlink" title="Worker Pool"></a>Worker Pool</h4><p>Worker Poolï¼ˆå·¥ä½œæ± ï¼‰æ˜¯ä¸€ç§å¹¶å‘è®¾è®¡æ¨¡å¼ï¼Œå®ƒç»´æŠ¤ä¸€ç»„é¢„å…ˆåˆ›å»ºçš„ goroutineï¼ˆå·¥äººï¼‰ï¼Œè¿™äº› goroutine ç­‰å¾…æ‰§è¡Œä»»åŠ¡ã€‚è¿™ç§æ¨¡å¼å¯ä»¥æ§åˆ¶å¹¶å‘æ•°é‡ï¼Œé¿å…åˆ›å»ºè¿‡å¤šçš„ goroutineï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ã€‚</p>
<p>ä»»åŠ¡1 ä»»åŠ¡2 ä»»åŠ¡3 ä»»åŠ¡4 ä»»åŠ¡5<br>  â†“    â†“    â†“    â†“    â†“<br>â€”â€”â€”â€”- jobs é˜Ÿåˆ— â€”â€”â€”-<br>     â†“        â†“        â†“<br>   å·¥äºº1    å·¥äºº2    å·¥äºº3<br>     â†“        â†“        â†“<br>â€”â€”â€”â€”- results é˜Ÿåˆ— â€”â€”-<br>  â†“    â†“    â†“    â†“    â†“<br>å¤„ç†å®Œæˆï¼Œæ”¶é›†ç»“æœ</p>
<p>ç®€å•çš„ Worker Pool å®ç°</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;fmt&quot;</span><br>	<span class="hljs-string">&quot;sync&quot;</span><br>	<span class="hljs-string">&quot;time&quot;</span><br>)<br><br><span class="hljs-comment">// ç®€å•çš„ä»»åŠ¡ç»“æ„</span><br><span class="hljs-keyword">type</span> Task <span class="hljs-keyword">struct</span> &#123;<br>	ID   <span class="hljs-type">int</span><br>	Name <span class="hljs-type">string</span><br>&#125;<br><br><span class="hljs-comment">// ç®€å•çš„ Worker Pool</span><br><span class="hljs-keyword">type</span> SimpleWorkerPool <span class="hljs-keyword">struct</span> &#123;<br>	workers <span class="hljs-type">int</span>            <span class="hljs-comment">// å·¥äººæ•°é‡</span><br>	tasks   <span class="hljs-keyword">chan</span> Task      <span class="hljs-comment">// ä»»åŠ¡é˜Ÿåˆ—</span><br>	wg      sync.WaitGroup <span class="hljs-comment">// ç­‰å¾…ç»„</span><br>&#125;<br><br><span class="hljs-comment">// åˆ›å»ºç®€å•çš„ Worker Pool</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewSimpleWorkerPool</span><span class="hljs-params">(workers <span class="hljs-type">int</span>)</span></span> *SimpleWorkerPool &#123;<br>	<span class="hljs-keyword">return</span> &amp;SimpleWorkerPool&#123;<br>		workers: workers,<br>		tasks:   <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> Task, <span class="hljs-number">100</span>),<br>	&#125;<br>&#125;<br><br><span class="hljs-comment">// å¯åŠ¨ Worker Pool</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(swp *SimpleWorkerPool)</span></span> Start() &#123;<br>	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; swp.workers; i++ &#123;<br>		swp.wg.Add(<span class="hljs-number">1</span>)<br>		<span class="hljs-keyword">go</span> swp.worker(i)<br>	&#125;<br>&#125;<br><br><span class="hljs-comment">// å·¥äººå¤„ç†ä»»åŠ¡</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(swp *SimpleWorkerPool)</span></span> worker(id <span class="hljs-type">int</span>) &#123;<br>	<span class="hljs-keyword">defer</span> swp.wg.Done()<br><br>	<span class="hljs-keyword">for</span> task := <span class="hljs-keyword">range</span> swp.tasks &#123;<br>		fmt.Printf(<span class="hljs-string">&quot;Worker %d å¤„ç†ä»»åŠ¡ %d: %s\n&quot;</span>, id, task.ID, task.Name)<br>		<span class="hljs-comment">// æ¨¡æ‹Ÿå·¥ä½œè€—æ—¶</span><br>		time.Sleep(time.Millisecond * <span class="hljs-number">500</span>)<br>		fmt.Printf(<span class="hljs-string">&quot;Worker %d å®Œæˆä»»åŠ¡ %d\n&quot;</span>, id, task.ID)<br>	&#125;<br>&#125;<br><br><span class="hljs-comment">// æäº¤ä»»åŠ¡</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(swp *SimpleWorkerPool)</span></span> Submit(task Task) &#123;<br>	swp.tasks &lt;- task<br>&#125;<br><br><span class="hljs-comment">// å…³é—­å¹¶ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(swp *SimpleWorkerPool)</span></span> Close() &#123;<br>	<span class="hljs-built_in">close</span>(swp.tasks)<br>	swp.wg.Wait()<br>&#125;<br><br><span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæœ‰ 3 ä¸ªå·¥äººçš„ Worker Pool</span><br>	pool := NewSimpleWorkerPool(<span class="hljs-number">3</span>)<br>	pool.Start()<br><br>	<span class="hljs-comment">// æäº¤ 10 ä¸ªä»»åŠ¡</span><br>	<span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">10</span>; i++ &#123;<br>		pool.Submit(Task&#123;<br>			ID:   i,<br>			Name: fmt.Sprintf(<span class="hljs-string">&quot;Task-%d&quot;</span>, i),<br>		&#125;)<br>	&#125;<br><br>	<span class="hljs-comment">// å…³é—­å¹¶ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span><br>	pool.Close()<br>	fmt.Println(<span class="hljs-string">&quot;æ‰€æœ‰ä»»åŠ¡å®Œæˆ!&quot;</span>)<br>&#125;<br><br></code></pre></td></tr></table></figure>


<h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><p>ç»ƒä¹ é¢˜ç›®ï¼šç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼<br>é¢˜ç›®è¦æ±‚ï¼š<br>ç¼–å†™ä¸€ä¸ªç¨‹åºå®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼š<br>åˆ›å»ºä¸€ä¸ªç”Ÿäº§è€… goroutineï¼Œç”Ÿæˆ 50 ä¸ªéšæœºæ•°ï¼ˆèŒƒå›´ 1-100ï¼‰<br>åˆ›å»º 3 ä¸ªæ¶ˆè´¹è€… goroutineï¼Œä»åŒä¸€ä¸ª channel æ¥æ”¶å¹¶å¤„ç†æ•°æ®<br>æ¯ä¸ªæ¶ˆè´¹è€…æ¥æ”¶åˆ°æ•°æ®åï¼Œæ‰“å°å‡ºå¤„ç†ç»“æœï¼ˆä¾‹å¦‚ï¼šæ¶ˆè´¹è€…ID + æ¥æ”¶åˆ°çš„æ•°å­—ï¼‰<br>ä¸»ç¨‹åºéœ€è¦ç­‰å¾…æ‰€æœ‰ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å®Œæˆå·¥ä½œåï¼Œæ‰“å°â€æ‰€æœ‰ä»»åŠ¡å®Œæˆâ€<br>å…·ä½“è¦æ±‚ï¼š<br>ä½¿ç”¨ channel åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´ä¼ é€’æ•°æ®<br>ç”Ÿäº§è€…å®Œæˆç”Ÿäº§åè¦å…³é—­ channel<br>æ¶ˆè´¹è€…ä½¿ç”¨ range ä» channel è¯»å–æ•°æ®ï¼Œè‡ªåŠ¨æ„ŸçŸ¥ channel å…³é—­<br>ä½¿ç”¨ sync.WaitGroup ç­‰å¾…æ‰€æœ‰ goroutine å®Œæˆ</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs go"><br><span class="hljs-keyword">var</span> (<br>	<span class="hljs-comment">//ç¼“å†²åŒºå¤§å°å¯ä»¥åŒºåˆ†ç”Ÿäº§è€…æ˜¯ç–¯ç‹‚ç”Ÿäº§ï¼Œè¿˜æ˜¯ç”Ÿäº§ä¸€éƒ¨åˆ†é˜»å¡ç­‰æ¶ˆè´¹è€…æ¶ˆè´¹ä¹‹åå†ç”Ÿäº§</span><br>	ch = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, <span class="hljs-number">50</span>)<br>	wg sync.WaitGroup<br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">produce</span><span class="hljs-params">(c <span class="hljs-keyword">chan</span>&lt;- <span class="hljs-type">int</span>)</span></span> &#123;<br>	<span class="hljs-keyword">defer</span> wg.Done()<br>	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">50</span>; i++ &#123;<br>		c &lt;- rand.Intn(<span class="hljs-number">100</span>) + <span class="hljs-number">1</span><br>	&#125;<br>	<span class="hljs-built_in">close</span>(c)<span class="hljs-comment">//æ ‡è®°é˜Ÿåˆ—å·²å…³é—­ï¼Œä¸ä¼šæ¸…ç©ºç¼“å†²åŒº</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">consume</span><span class="hljs-params">(i &lt;-<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, id <span class="hljs-type">int</span>)</span></span> &#123;<br>	<span class="hljs-keyword">defer</span> wg.Done()<br>	<span class="hljs-keyword">for</span> c := <span class="hljs-keyword">range</span> i &#123;<br>		fmt.Println(<span class="hljs-string">&quot;æ¶ˆè´¹è€…d%å¤„ç†äº†æ•°å­—ï¼šd%&quot;</span>, id, c)<br>	&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	rand.Seed(time.Now().UnixNano())<br><br>	wg.Add(<span class="hljs-number">1</span>)<br>	<span class="hljs-keyword">go</span> produce(ch)<br>	<span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">3</span>; i++ &#123;<br>		wg.Add(<span class="hljs-number">1</span>)<br>		<span class="hljs-keyword">go</span> consume(ch, i)<br>	&#125;<br>	wg.Wait()<br>	fmt.Println(<span class="hljs-string">&quot;æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•&quot;</span>)<br>&#125;<br><br></code></pre></td></tr></table></figure>


<h3 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h3><p>Context æ˜¯ Go è¯­è¨€æ ‡å‡†åº“æä¾›çš„ä¸€ç§ä¸Šä¸‹æ–‡ä¼ é€’æœºåˆ¶ï¼Œç”¨äºåœ¨å¤šä¸ª goroutine ä¹‹é—´ä¼ é€’å–æ¶ˆä¿¡å·ã€‚Context å¯ä»¥åœ¨ä»»æ„å±‚çº§ä¼ é€’ï¼Œå¹¶ä¸”å¯ä»¥å–æ¶ˆï¼Œä¹Ÿå¯ä»¥è¶…æ—¶ã€‚<br>Context çš„ä¸»è¦ä½œç”¨æ˜¯ï¼š<br>å–æ¶ˆï¼ˆcancelï¼‰ï¼šä¸Šæ¸¸é€šçŸ¥ä¸‹æ¸¸â€œç«‹å³åœæ­¢â€ã€‚<br>è¶…æ—¶ï¼ˆtimeout&#x2F;deadlineï¼‰ï¼šåˆ°ç‚¹è‡ªåŠ¨å–æ¶ˆã€‚<br>ä¼ å€¼ï¼ˆvalueï¼‰ï¼šè·¨ API è¾¹ç•Œæºå¸¦è¯·æ±‚çº§å…¬å…±æ•°æ®ï¼ˆå¦‚ trace-idã€ç”¨æˆ·èº«ä»½ï¼‰ï¼Œé¿å…æ¯ä¸ªå‡½æ•°éƒ½åŠ å‚æ•°,è¿™åœ¨é¡¹ç›®å¼€å‘æ—¶å€™ç‰¹åˆ«æœ‰ç”¨ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Context <span class="hljs-keyword">interface</span> &#123;<br>	Deadline() (deadline time.Time, ok <span class="hljs-type">bool</span>)<br>	Done() &lt;-<span class="hljs-keyword">chan</span> <span class="hljs-keyword">struct</span>&#123;&#125;<br>	Err() <span class="hljs-type">error</span><br>	Value(key any) any<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h4 id="æ¥ä¸‹æ¥æ˜¯ä¸€äº›ç®€å•çš„ä¾‹å­ï¼š"><a href="#æ¥ä¸‹æ¥æ˜¯ä¸€äº›ç®€å•çš„ä¾‹å­ï¼š" class="headerlink" title="æ¥ä¸‹æ¥æ˜¯ä¸€äº›ç®€å•çš„ä¾‹å­ï¼š\"></a>æ¥ä¸‹æ¥æ˜¯ä¸€äº›ç®€å•çš„ä¾‹å­ï¼š\</h4><p><em>å–æ¶ˆï¼š</em></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;context&quot;</span><br>	<span class="hljs-string">&quot;fmt&quot;</span><br>	<span class="hljs-string">&quot;time&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">temp</span><span class="hljs-params">(ctx context.Context)</span></span> &#123;<br>	<span class="hljs-keyword">for</span> &#123;<br>		<span class="hljs-keyword">select</span> &#123;<br>		<span class="hljs-keyword">case</span> &lt;-ctx.Done():<br>			fmt.Println(<span class="hljs-string">&quot;ä»»åŠ¡ç»“æŸ&quot;</span>)<br>			<span class="hljs-keyword">return</span><br>		<span class="hljs-keyword">default</span>:<br>			time.Sleep(time.Second)<br>			fmt.Println(<span class="hljs-string">&quot;ç¡äº†ä¸€ç§’&quot;</span>)<br>		&#125;<br>	&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	ctx, cancel := context.WithCancel(context.Background())<br>	<span class="hljs-keyword">go</span> temp(ctx)<br>	time.Sleep(time.Second * <span class="hljs-number">5</span>)<br>	cancel()<br>	time.Sleep(time.Millisecond * <span class="hljs-number">500</span>)<span class="hljs-comment">//é¿å…ä»»åŠ¡ç»“æŸå¤ªå¿«</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p><em>è¶…æ—¶ï¼š</em></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;context&quot;</span><br>	<span class="hljs-string">&quot;fmt&quot;</span><br>	<span class="hljs-string">&quot;time&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">temp</span><span class="hljs-params">(ctx context.Context)</span></span> &#123;<br>	<span class="hljs-keyword">for</span> &#123;<br>		<span class="hljs-keyword">select</span> &#123;<br>		<span class="hljs-keyword">case</span> &lt;-ctx.Done():<br>			fmt.Println(<span class="hljs-string">&quot;ä»»åŠ¡ç»“æŸ&quot;</span>)<br>			<span class="hljs-keyword">return</span><br>		<span class="hljs-keyword">default</span>:<br>			time.Sleep(time.Second)<br>			fmt.Println(<span class="hljs-string">&quot;ç¡äº†ä¸€ç§’&quot;</span>)<br>		&#125;<br>	&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	ctx, _ := context.WithDeadline(context.Background(), time.Now().Add(time.Second*<span class="hljs-number">3</span>)) <span class="hljs-comment">//æˆ–è€…ç”¨WithTimeout</span><br>	<span class="hljs-keyword">go</span> temp(ctx)<br>	time.Sleep(time.Second * <span class="hljs-number">5</span>)<span class="hljs-comment">//ä¸‰ç§’æ—¶å€™å°±ç»“æŸäº†</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p><em>ä¼ å€¼ï¼š</em></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;context&quot;</span><br>	<span class="hljs-string">&quot;fmt&quot;</span><br>	<span class="hljs-string">&quot;time&quot;</span><br>)<br><br><span class="hljs-keyword">type</span> key <span class="hljs-type">string</span> <span class="hljs-comment">// é¿å…å†²çª</span><br><br><span class="hljs-keyword">const</span> traceIDKey key = <span class="hljs-string">&quot;traceID&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">worker</span><span class="hljs-params">(ctx context.Context)</span></span> &#123;<br>	<span class="hljs-keyword">if</span> v := ctx.Value(traceIDKey); v != <span class="hljs-literal">nil</span> &#123;<br>		fmt.Printf(<span class="hljs-string">&quot;worker: æ”¶åˆ° traceID=%s\n&quot;</span>, v)<br>	&#125;<br>	&lt;-ctx.Done()<br>	fmt.Println(<span class="hljs-string">&quot;worker: é€€å‡º&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	<span class="hljs-comment">// æŠŠ traceID å¡è¿› context</span><br>	ctx, cancel := context.WithCancel(context.Background())<br>	ctx = context.WithValue(ctx, traceIDKey, <span class="hljs-string">&quot;å‰é¢é‚£ä¸ªæ˜¯ğŸ—¡ï¼Œè¿™ä¸ªæ˜¯å€¼&quot;</span>)<br>	<span class="hljs-keyword">go</span> worker(ctx)<br>	<span class="hljs-comment">// ç®€å•ç­‰ç­‰ï¼Œè®© goroutine å…ˆæ‰“å°</span><br>	time.Sleep(time.Second)<br>	cancel()<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>ä»ä¸Šé¢è¿™é‡Œä¾‹å­å°±å¯ä»¥çœ‹å‡ºï¼Œcontextå¯ä»¥æ§åˆ¶goroutineçš„å…³é—­å’Œä¼ å€¼ï¼Œè¿™åœ¨goroutineå¥—goroutineçš„æƒ…å†µä¸‹éå¸¸å¥½ç”¨ï¼Œä¸ä»…å¯ä»¥ä¼ å€¼ï¼Œè¿˜å¯ä»¥ä¸€æ¬¡æ€§å…³é—­æ•´ä¸ªgoroutineæ ‘ã€‚ç¾æ±æ±ğŸ˜›</p>
</blockquote>
<p>å¥½äº†ï¼Œåˆ°è¿™é‡Œè¿™ç¯‡å…³äº Go å¹¶å‘ç¼–ç¨‹çš„æ–‡ç« å°±å·®ä¸å¤šå•¦ï¼ğŸ˜„<br>å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™æˆ‘è‡ªå·±ä¹Ÿé‡æ–°æ¢³ç†äº†ä¸€éï¼Œè¿™äº›å°demoä¹Ÿæ˜¯éå¸¸ç®€çŸ­å’Œç®€å•ï¼Œä½†æ˜¯å†™ä¸€éè¿˜æ˜¯ååˆ†çš„helpfulã€‚èµ·ç è®°å¿†ä¸Šæ¥è¯´æœ‰ç‚¹ç”¨ã€‚</p>

  </div>

  <br />

  
  <br /><br />


  

<div id="copyright">

  <a id="license-image" rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img height="15" width="80" alt="çŸ¥è¯†å…±äº« ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" />
  </a>

  <p id="license-word-hyper">
    æœ¬ä½œå“é‡‡ç”¨
    <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
    çŸ¥è¯†å…±äº« ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®</a>
    è¿›è¡Œè®¸å¯ã€‚
  </p>
</div>

  <div id="top">
  <div onclick="window.scrollTo({top: 0, behavior: 'smooth'})">â–²</div>
  <div onclick="document.getElementById('footer').scrollIntoView({behavior: 'smooth'})">â–¼</div>
</div>
  

</post>
  </div>

  <foot id="footer">
  <hr class="boldline" />
  <br>

  <p class="center font">
    
    <a target="_blank" rel="noopener" href="https://github.com/UndertaK33r" aria-label="GitHub">
  <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
   <path class="icon_path" d="M427.392 853.504a61.44 61.44 0 0 1-1.450667 15.530667 92.586667 92.586667 0 0 1-10.965333 27.605333c-15.061333 25.301333-40.661333 42.154667-73.642667 42.154667-77.653333 0-108.117333-38.101333-146.261333-133.504C169.216 740.693333 157.013333 725.461333 128 725.461333v-85.333333c77.653333 0 108.117333 38.101333 146.261333 133.504 25.856 64.597333 38.058667 79.786667 67.072 79.786667 0-12.373333-0.170667-23.296-0.512-38.144-0.853333-34.816-0.938667-41.941333 0.554667-51.2 0.64-20.352 5.888-34.773333 16.384-49.066667-95.232-20.736-159.445333-63.573333-196.309333-132.992l-13.824-32.426667C134.186667 510.848 128 467.072 128 416.426667c0-58.24 17.749333-110.336 50.944-153.856-10.368-41.386667-8.96-91.989333 13.909333-149.077334l7.466667-18.688 19.2-6.101333c2.56-0.853333 5.632-1.578667 9.301333-2.133333 37.290667-5.888 90.325333 8.106667 159.701334 52.48a565.930667 565.930667 0 0 1 127.274666-14.208c38.741333 0 77.226667 3.882667 114.048 11.605333 67.456-42.24 119.04-55.509333 155.306667-49.92 3.626667 0.597333 6.741333 1.322667 9.258667 2.133333l19.285333 6.101334 7.466667 18.773333c20.010667 50.218667 23.424 96.469333 16.128 136.96C875.434667 296.32 896 352.597333 896 416.512c0 53.888-3.84 94.378667-14.933333 133.802667l-11.733334 32.170666c-30.677333 69.333333-98.304 112.64-202.538666 133.248 10.837333 15.018667 15.872 30.250667 15.872 52.394667v42.666667l-0.042667 42.666666a13.013333 13.013333 0 0 0 0.341333 2.730667L682.666667 938.794667c-36.352 0-63.36-17.706667-76.672-45.653334a88.277333 88.277333 0 0 1-8.661334-40.277333v-84.736c0-3.584-0.128-3.797333-8.832-12.501333-23.296-23.296-33.834667-40.874667-33.834666-72.832v-38.613334l38.4-3.84c114.346667-11.52 176.512-43.221333 197.12-89.6l9.6-26.325333c7.68-27.562667 10.88-61.098667 10.88-107.946667 0-49.706667-17.365333-90.837333-50.218667-123.648L742.4 274.773333l7.381333-24.448c6.528-21.717333 8.106667-47.402667 1.152-76.714666a158.634667 158.634667 0 0 0-3.584 0.938666c-22.826667 6.4-51.370667 20.053333-85.76 43.008l-15.658666 10.453334-18.304-4.522667a467.754667 467.754667 0 0 0-111.829334-13.269333c-42.709333 0-84.906667 5.418667-123.946666 16.042666l-19.029334 5.205334-16.256-11.136c-35.541333-24.32-65.109333-38.826667-88.746666-45.568a158.293333 158.293333 0 0 0-4.864-1.28c-8.234667 33.92-4.992 61.781333 3.413333 82.688l9.984 25.088-18.346667 19.797333C228.693333 332.629333 213.333333 370.986667 213.333333 416.512c0 41.685333 4.864 76.202667 13.824 102.229333l11.178667 26.453334c27.904 52.352 87.168 83.84 192.853333 95.146666l38.144 4.096v38.357334c0 32-10.538667 49.536-33.834666 72.832-8.704 8.704-8.832 8.96-8.832 12.501333l-0.725334 7.893333c-0.512 2.56-0.512 9.258667 0.170667 37.205334 0.298667 12.8 0.469333 22.997333 0.554667 33.621333a33.962667 33.962667 0 0 1 0.725333 6.656z"/>
  </svg>
 </a>

    
    
    <a href="mailto:2331627921@qq.com" aria-label="Email">
  <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <path d="M513.78 602.99c-27.28 0.45-53.79-9.09-74.53-26.83l-65.96-56.64c-15.64-13.37-17.48-36.9-4.1-52.54 13.38-15.65 36.9-17.48 52.54-4.1l65.96 56.64c13.68 11.1 33.27 11.1 46.95 0L881.2 253.08l-708.02-2.61c-20.58 0-37.26-16.69-37.26-37.26s16.68-37.26 37.26-37.26H881.2c41.09-2.36 76.32 29.05 78.67 70.14a74.519 74.519 0 0 1-32.46 65.87L580.86 578.38a111.842 111.842 0 0 1-67.08 24.61z m444.57 133.4V438.28c0-20.58-16.68-37.26-37.26-37.26s-37.26 16.69-37.26 37.26V736.4c0 20.58-16.68 37.26-37.26 37.26h-521.7c-20.58 0-37.26 16.69-37.26 37.26s16.68 37.26 37.26 37.26h521.7c61.72 0.01 111.78-50.05 111.78-111.79zM362.12 363.75c0-20.58-16.68-37.26-37.26-37.26h-223.6c-20.58 0-37.26 16.69-37.26 37.26s16.68 37.26 37.26 37.26h223.59c20.58 0.01 37.27-16.68 37.27-37.26z m0 298.12c0-20.58-16.68-37.26-37.26-37.26h-111.8c-20.58 0-37.26 16.69-37.26 37.26s16.68 37.26 37.26 37.26h111.79c20.58 0 37.27-16.69 37.27-37.26z"/>
  </svg>
</a>

    
    
    
    
    
    
    
    
    
  <p>
    <br>
  <p id="hitokoto">:D è·å–ä¸­...</p>
  <script src="https://v1.hitokoto.cn/?c=a&encode=js&select=%23hitokoto" defer></script>
  <br>
  <p class="center font">
    &copy - <a href="https://UndertaK33r.github.io">UndertaK33r</a> -  2025 - Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>  Theme <a target="_blank" rel="noopener" href="https://github.com/pcrab/hexo-theme-quark"> Quark </a> 
  </p>
  
  <br />
</foot>
  
  <!-- particles.js åˆå§‹åŒ–è„šæœ¬ -->
  <script>
    // particles.js é…ç½® - é€‚åº¦å¢å¼ºç²’å­æ•ˆæœ
    particlesJS('particles-js', {
      "particles": {
        "number": {
          "value": 55,  /* é€‚åº¦å¢åŠ ç²’å­æ•°é‡ */
          "density": {
            "enable": true,
            "value_area": 1000  /* é€‚åº¦å¢åŠ å¯†åº¦ */
          }
        },
        "color": {
          "value": "#7dd3fc"
        },
        "shape": {
          "type": "circle",
          "stroke": {
            "width": 0,
            "color": "#000000"
          }
        },
        "opacity": {
          "value": 0.45,  /* æé«˜é€æ˜åº¦ï¼Œå¢å¼ºå¯è§åº¦ */
          "random": true,
          "anim": {
            "enable": true,
            "speed": 0.8,  /* é€‚åº¦åŠ å¿«é€æ˜åº¦å˜åŒ– */
            "opacity_min": 0.1,
            "sync": false
          }
        },
        "size": {
          "value": 2,  /* é€‚åº¦å¢å¤§ç²’å­å°ºå¯¸ */
          "random": true,
          "anim": {
            "enable": true,
            "speed": 1.2,  /* åŠ å¿«å¤§å°å˜åŒ– */
            "size_min": 0.3,
            "sync": false
          }
        },
        "line_linked": {
          "enable": true,
          "distance": 130,  /* å¢åŠ è¿æ¥è·ç¦»ï¼Œæ›´å®¹æ˜“å½¢æˆç½‘ç»œ */
          "color": "#7dd3fc",
          "opacity": 0.25,  /* é€‚åº¦æé«˜è¿æ¥çº¿é€æ˜åº¦ */
          "width": 1
        },
        "move": {
          "enable": true,
          "speed": 1.2,  /* é€‚åº¦åŠ å¿«ç§»åŠ¨é€Ÿåº¦ */
          "direction": "none",
          "random": true,
          "straight": false,
          "out_mode": "out",
          "bounce": false,
          "attract": {
            "enable": false,
            "rotateX": 600,
            "rotateY": 1200
          }
        }
      },
      "interactivity": {
        "detect_on": "canvas",
        "events": {
          "onhover": {
            "enable": true,
            "mode": "grab"  /* ä¿æŒé¼ æ ‡äº¤äº’ */
          },
          "onclick": {
            "enable": true,  /* é‡æ–°å¯ç”¨ç‚¹å‡»äº¤äº’ï¼Œå¢åŠ äº’åŠ¨æ€§ */
            "mode": "push"
          },
          "resize": true
        },
        "modes": {
          "grab": {
            "distance": 150,  /* å¢åŠ æŠ“å–è·ç¦» */
            "line_linked": {
              "opacity": 0.5  /* æŠ“å–æ—¶çº¿æ¡æ›´æ˜æ˜¾ */
            }
          },
          "bubble": {
            "distance": 100,
            "size": 40,
            "duration": 2,
            "opacity": 8,
            "speed": 3
          },
          "repulse": {
            "distance": 200,
            "duration": 0.4
          },
          "push": {
            "particles_nb": 3  /* ç‚¹å‡»æ—¶æ·»åŠ 3ä¸ªç²’å­ */
          },
          "remove": {
            "particles_nb": 2
          }
        }
      },
      "retina_detect": true
    });
  </script>
</body>

</html>